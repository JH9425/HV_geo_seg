\section{Data}\label{sec:data}
To execute the analysis we rely on household-level scanner data comprising 68 FMCG categories from Belgium, France, Germany and the Netherlands. In each country, a market research firm provides a panel of households with a scanning device to register for each purchased barcode the number of units bought, the total volume purchased and the total tax-inclusive monetary value of the transaction.\footnote{The market research firm in Belgium, Germany and the Netherlands is GfK. In France, the data is gathered by Kantar. We were granted access to the data by AIMARK (Advanced International Marketing Knowledge).} In addition, buyers report the retail chain in which the product was purchased. We focus on a relatively stable period from 2010 until 2019, omitting the trough of the financial crisis and the start of the COVID-19 pandemic. We now provide more detail on the construction of the sample, and the dimensions and suitability of the data.

We restrict attention to Belgium, France, Germany and the Netherlands for two reasons. First, this group of countries is probably among the most integrated countries in the Common Market. All countries were founding partners of the European Economic Area, they have always partaken in the successive integration efforts to form the Common Market and they use the Euro as their currency. For this reason, our results likely provide a conservative estimate of the degree of market segmentation across countries in the Common Market as other countries have either joined at a later stage or use a different local currency. Second, focusing on countries that share the same currency makes relying on cost-of-living differences, or real exchange rate variation, appealing to assess the degree of geographic goods market segmentation. When countries have fluctuating nominal exchange rates, imperfections in financial markets or monetary policy shocks can induce variation in nominal exchange rates which in turn spill into real exchange rates when nominal prices are sticky (see \citet{Heathcote2014} and \citet{Itskhoki2021}). Like \citet{Berka2018}, we choose to focus on a set of countries that share the same currency to ensure that real exchange rate variation is mostly determined by real factors and not by financial or monetary ones. 

We focus on a set of 68 FMCG product categories, ranging from food, alcoholic and non-alcoholic beverages to personal care items that jointly represent around 15\% in total final consumer spending. In all countries, the raw data contain more than the 68 product categories we include, but we limit the set of product categories for two reasons (see Table \ref{tab: app_data_prod_cat_excluded}). First, we only keep product categories that are consumed by more than 5\% of the households in all countries. Second, product categories such as medicines and first aid products are omitted because the extent to which consumers can access them through retail stores differs across countries.\footnote{For instance, the distribution of these products is much more regulated in Belgium compared to the Netherlands.} Still, our sample covers most of the recorded expenditure as the excluded product categories never account for more than 11\% of total expenditures in any of the countries when taken together (Table \ref{tab: app_bars_firms_barcode_type}). Figure \ref{fig: app_data_prod_cat_overview} shows the distribution of expenditure shares across the included product categories.

The transaction data records purchases at the barcode level and associates each barcode with an 8- or 13-digit EAN code.\footnote{One example of a product variety is a 6-pack 330ML Can Coca-Cola Regular. Generally, barcodes carry a 13-digit identifier. However, there is a small set of product varieties that are sold in small packages, e.g. spices or small shampoo bottles or that are individually sold, e.g. small soda bottles. These product varieties will have a smaller 8-digit identifier.} We combine package information obtained from the barcode descriptions with information about units sold, volume sold and expenditure to compute quantity consumed in terms of metric units (number of liters, kilograms or units consumed) and unit prices in terms of prices per liters, kilograms and units.\footnote{As barcode descriptions are provided by the local affiliate of the market research firms, there are a limited number of cases in which the exact barcode description for identical barcodes differs across countries. In these cases, we assume that this is due to measurement error and associate each barcode with one package size across countries such that price differences do not stem from differences in package size.} When studying the degree of geographic market segmentation, scanner data offer three distinct advantages. First, observing barcode-level or product variety-level prices ensures that LOP deviations do not stem from differences in unobserved product characteristics. Since barcodes are inexpensive to acquire and retailers base their inventory systems on barcodes there are operational incentives to associate distinct product varieties with unique barcodes. Also, the EAN system is globally managed through GS1 and therefore two different firms will not be able to sell two different product varieties under the same EAN code.\footnote{GS1 is a global non-profit company that is in charge of, among other things, allocating unique EAN barcodes. They make sure that EAN codes are unique such that products can easily be identified by their EAN barcode} Second, in addition to product variety-level prices, scanner data also record product variety-level data on physical quantities. Observing both variables at the same time is essential to estimate a structural model of demand and separate spatial differences in tastes from spatial differences in LOP deviations and choice sets. Finally, within the selected product categories, scanner data provide a complete picture of the overall consumption basket. This makes identifying both shared or traded varieties and purely local alternatives possible.\footnote{Note that this is in stark contrast to the set of papers that rely on international trade data to study the relationship between market integration and differences in or changes in choice sets (e.g. \citet{Broda2006}, \citet{Kehoe2013} and \citet{Cavallo2022}). International trade data usually provides a detailed picture of the choice set comprising shared or traded varieties, but measuring domestic choice set is much harder, even though it is often more important than the choice set comprising shared or traded varieties (see \citet{Eaton2011}). One reason why this is particularly hard is that trade data is usually reported according to the Harmonized System classification, and domestic production and sales data are usually reported according to industry classifications such as the NACE or ISIC systems. See \citet{Amiti2019} for an application of matching trade and domestic price data.} In addition, because all countries in the sample use the same barcode system to define product varieties, consumption baskets are comparable across both intranational and international region pairs. 

While barcodes identify individual product varieties, it is possible that very similar product varieties, potentially even the same product variety, carry different barcodes across countries. Firms might deliberately offer different barcodes across countries to limit parallel imports by distributors or distributors might attach different barcodes to product varieties when they repackage products before selling to final consumers.\footnote{A recent example is antitrust procedure AT.40134 by the European Commission against AB Inbev. The European Commission fined Ab Inbev after it changed the labeling on beer sold to the Netherlands to prevent it from being offered in Belgium. Besides, it is well-known that the Belgian retail chain Colruyt repackages many products before selling them in their stores.} Hence, relying solely on the set of common barcodes across countries to study choice set differences across international region pairs could paint an inconsistent picture. To overcome this issue, we associate each barcode with a firm identifier by matching barcodes to firms using data from GS1 who provided us with a mapping from barcodes to firm identifiers.\footnote{See \citet{Hottman2016} for a similar approach and appendix \ref{app:data_bars_firms} for more detail on the exact procedure we use to overcome the aforementioned issues.} Table \ref{tab: app_bars_firms_barcode_type} indicates that we can allocate a firm identifier for around 75\% to 85\% of all expenditures depending on the country.\footnote{Usually, when we cannot allocate a firm identifier this is because the barcode did not follow the 13-digit EAN standard or because product variety does not have an associated brand. Non-standard 13 EAN-digit are prevalent in Belgium, Germany and the Netherlands in product categories that contain a large share of fresh produce, e.g. fresh vegetables, fresh meat, etc. .} In this way, we can study choice set differences across geographic markets both at the product variety-level and at the firm-level. To check the quality of the firm identifier, we replicate the descriptive statistics on the firm size distribution documented by \cite{Hottman2016} in Tables \ref{tab: app_bars_firms_avg_size} - \ref{tab: app_bars_firms_size_nupcs}.\footnote{More specifically, we document statistics about the overall firm size distribution, the upper tail of the distribution and within firm dispersion in expenditure across different barcodes.} We find that these empirical patterns are very similar across countries and closely replicate the patterns reported by \citet{Hottman2016} for US scanner data. By specifying a preference structure with nests at the product variety and firm level, our preference structure is flexible enough to capture the empirical regularities that characterize the heterogeneous multi-product firms that make up our dataset.

We link household characteristics to each purchase through a unique household identifier reported in transaction data. Crucially, we observe the region of residence and the ZIP code of the household. We combine the region of residence and ZIP-code data to establish their region of residence at the NUTS2 level and determine product variety-level prices, quantities and choice sets at a fine spatially disaggregate level. As we quantify the degree of geographic market segmentation across regions in terms of the yearly cost-of-living differences, we need to ensure that we have a representative picture of the consumption baskets of consumers in the different regions. To minimize the impact of measurement error through occasional consumption or consumers that rotate in and out of the sample in the middle of the year, we only include consumers in a given year if they register transactions in each quarter of the year. Depending on the country, the main sample includes between 3,200 and 23,348 households each year accounting for 60\%-91\% of total recorded expenditure within the select product categories (see Table \ref{tab: app_households_excluded}). Figures \ref{fig: app_data_households_bar_year} - \ref{fig: app_data_households_stores_year} illustrate that the distributions of weekly shopping trips, the number of weekly purchases and the number of purchased barcodes are very similar across countries for the set of consumers that we focus on. This provides some assurance that we are comparing consumption baskets across countries for consumers with very similar overall purchase behavior. To ensure that we measure choice sets in a region as completely as possible, we use the full sample of households when determining the set of available product varieties and firms. 

As mentioned before, the transaction data also record the retail chain at which the purchase was made. There are roughly six store types included in the data. Grocery stores (e.g. Carrefour Hyper, Hyper U) and hypermarkets (e.g. GB, Super U) are food and non-food supermarkets which are not discounters. Hypermarkets and grocery stores are large and mid-sized supermarkets respectively. Discounters are stores with an everyday low-price strategy (e.g. Aldi, Lidl). Convenience stores are smaller stores that have a limited assortment and focus on quick purchases. This group consists of the small store formats of larger retail chains (e.g. Carrefour Express, U Express), kiosks (e.g. 7-Eleven, Relay) and petrol stations (e.g. Total, Esso). Drugstores are stores that focus on mostly non-food items (e.g. Hema, MAC, KIKO). Finally, specialist stores are stores that tend to stock a limited number of product categories and are made up of bakers, liquor stores, butchers, etc. . Whereas specialist stores are often small independent stores that sell within one or two product categories, drugstores are often chains that sell across a wider set of product categories. We exclude cross-border transactions and online purchases that were made at an online retailer with no brick-and-mortar counterpart. Table \ref{tab: app_data_stores_overview} provides an overview of the importance of the different stores across countries and shows that most purchases are made at brick-and-mortar stores. Hence, omitting cross-border transactions and online purchases still leaves us with a very comprehensive picture of overall consumption baskets within the selected product categories. 

To account for geographic differences across NUTS2 regions, we complement the consumption data with geographical data from three separate data sources. First, we use concordance tables from Eurostat to match ZIP codes and regions to their corresponding NUTS2-level.\footnote{After administrative reforms in 2016, France changed their NUTS-classifications. Because the regional variable in the French dataset corresponds to the NUTS2-level of the pre-2016 NUTS2 version, we use the 2013 version of the NUTS regions throughout the paper.} In addition, we use data from Eurostat's GISCO services to obtain longitudes and latitudes for each of the ZIP codes. We determine the population-weighted centroids of each NUTS2 region and compute great circle distances between them. Second, we obtain elevation data from the US Geological Survey at the 30arc seconds level to determine the elevation differences between NUTS2 regions. Finally, the European Environmental Agency provides the region of river basins from which we construct whether the NUTS2 regions share a river basin. 